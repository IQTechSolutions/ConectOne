@page "/teachers/create"
@using ConectOne.Blazor.Components
@using FilingModule.Blazor.Modals
@using FilingModule.Domain.Enums
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Forms
@using MudBlazor
@using SchoolsModule.Application.ViewModels
@using SchoolsModule.Domain.Entities

@attribute [Authorize]

<EditForm Model="Teacher" OnValidSubmit="CreateAsync">
<MudGrid>
    <MudItem md="6">
        <DefaultTitle Title="Create New Teacher" Caption="Complete the information to add new teacher" />
    </MudItem>
    <MudItem md="6" Style="float:right">
        <MudBreadcrumbs Items="_items" Style="float:right"></MudBreadcrumbs>
    </MudItem>
    <MudItem md="12">

        <MudTabs>
           
            <DataAnnotationsValidator />
            <MudGrid>
                <MudItem xs="12" sm="12" md="3" lg="3">
                    <MudSingleImageCropperUpload OnFileAccepted="CoverImageChanged" Caption="@($"{Teacher.FirstName} {Teacher.LastName}")" Src="@_imageSource" ImageType="UploadType.Cover" Entity="typeof(Teacher)" ParentId="@Teacher.TeacherId" />
                    <MudDivider />
                    <MudCard>
                        <MudCardContent>
                            <MudGrid>
                                    
                            </MudGrid>
                        </MudCardContent>
                    </MudCard>
                </MudItem>
                <MudItem xs="12" sm="12" md="9" lg="9">
                    <MudCard>
                        <MudCardHeader>
                            <MudText Align="Align.Center" Typo="Typo.h6">Personal Information</MudText>
                        </MudCardHeader>
                        <MudCardContent>
                            <MudGrid>
                                <MudItem md="6">
                                    <MudTextField Label="First Name" Class="mt-3" @bind-Value="Teacher.FirstName" For="@(() => Teacher.FirstName)" Margin="Margin.Dense" Variant="Variant.Outlined" />
                                </MudItem>
                                <MudItem md="6">
                                    <MudTextField Label="Last Name" Class="mt-3" @bind-Value="Teacher.LastName" For="@(() => Teacher.LastName)" Margin="Margin.Dense" Variant="Variant.Outlined" />
                                </MudItem>

                                <MudItem md="6">
                                    <MudTextField Label="Phone Nr" Class="mt-3" @bind-Value="Teacher.ContactNumber.Number" For="@(() => Teacher.LastName)" Margin="Margin.Dense" Variant="Variant.Outlined" />
                                </MudItem>
                                <MudItem md="6">
                                    <MudTextField Label="Email Address" Class="mt-3" @bind-Value="Teacher.EmailAddress.EmailAddress" For="@(() => Teacher.LastName)" Margin="Margin.Dense" Variant="Variant.Outlined" />
                                </MudItem>

                                <MudItem md="6">
                                        <MudSelect T="SchoolGradeViewModel" Placeholder="No parent selected" ToStringFunc="@_schoolGradeConverter" Label="Grade" Value="@Teacher.Grade" ValueChanged="SelectedGradeChanged" AnchorOrigin="Origin.BottomCenter" Variant="Variant.Outlined" Margin="Margin.Dense">
                                        @if (AvailableGrades is not null)
                                        {
                                            foreach (var state in AvailableGrades)
                                            {
                                                <MudSelectItem Value="@state">@state.SchoolGrade</MudSelectItem>
                                            }
                                        }
                                    </MudSelect>
                                </MudItem>

                                <MudItem md="6">
                                    <MudSelect ToStringFunc="@_availableSchoolConverter" Label="Class" @bind-Value="@Teacher.Class" AnchorOrigin="Origin.BottomCenter" Variant="Variant.Outlined" Margin="Margin.Dense">
                                        @if (AvailableSchoolClasses is not null)
                                        {
                                            foreach (var state in AvailableSchoolClasses)
                                            {
                                                <MudSelectItem Value="@state">@state.SchoolClass</MudSelectItem>
                                            }
                                        }
                                    </MudSelect>
                                </MudItem>
                                <MudDivider />

                            </MudGrid>
                        </MudCardContent>
                    </MudCard>
                </MudItem>

            </MudGrid>
              
        </MudTabs>
    </MudItem>
    <MudItem xs="6" sm="6" md="6" lg="6">
        <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto" FullWidth>Save</MudButton>
    </MudItem>

    <MudItem xs="6" sm="6" md="6" lg="6">
        <MudButton OnClick="Cancel" Variant="Variant.Filled" Color="Color.Secondary" Class="ml-auto" FullWidth>Cancel</MudButton>
    </MudItem>
</MudGrid>
</EditForm>             